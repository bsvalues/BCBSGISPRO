<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TerraFusionSync User Guide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            margin-top: 30px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        .note {
            background-color: #f0f7fb;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 20px 0;
        }
        .warning {
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }
        .screenshot {
            margin: 20px 0;
            text-align: center;
        }
        .screenshot img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .screenshot-caption {
            font-style: italic;
            margin-top: 10px;
            color: #666;
        }
        .step {
            margin-bottom: 15px;
        }
        .step-number {
            display: inline-block;
            width: 25px;
            height: 25px;
            background-color: #3498db;
            color: white;
            text-align: center;
            line-height: 25px;
            border-radius: 50%;
            margin-right: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
            font-size: 0.9em;
            color: #777;
        }
        @media print {
            body {
                font-size: 12pt;
            }
            .screenshot img {
                max-height: 300px;
            }
            h1, h2, h3 {
                page-break-after: avoid;
            }
            .step {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <h1>TerraFusionSync User Guide</h1>
    <p style="text-align: center;">A visual guide to using the secure ICSF-compliant property data synchronization system</p>
    
    <h2>Introduction</h2>
    <p>Welcome to TerraFusionSync, your secure platform for managing property data updates. This guide will walk you through how to safely use the TerraFusionSync Admin Dashboard for uploading, reviewing, and approving PACS-related data updates.</p>
    
    <div class="note">
        <strong>Note:</strong> This guide includes screenshots to help you navigate the system. The actual interface may have minor visual differences based on your role and permissions.
    </div>

    <h2>Logging In</h2>
    <p>Access the dashboard at <strong>http://localhost:8000/dashboard</strong>. You will be prompted to authenticate with your County network credentials.</p>
    
    <div class="screenshot">
        <div style="background-color: #f5f5f5; padding: 20px; display: flex; justify-content: center; align-items: center;">
            <div style="background-color: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); padding: 30px; width: 400px; text-align: center;">
                <div style="margin-bottom: 20px; font-size: 24px; font-weight: bold; color: #2c3e50;">Terra<span style="color: #3498db;">Fusion</span>Sync</div>
                <h2 style="color: #2c3e50; margin-top: 0;">Authentication Required</h2>
                <p style="color: #7f8c8d; margin-bottom: 25px;">Please enter your County network credentials to continue</p>
                <div style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 16px; text-align: left; background-color: #fff;">CO\jdoe</div>
                <button style="background-color: #3498db; color: white; border: none; padding: 12px 25px; border-radius: 4px; cursor: pointer; font-size: 16px; width: 100%;">Authenticate</button>
            </div>
        </div>
        <div class="screenshot-caption">Fig. 1: Login screen where you enter your County network credentials</div>
    </div>
    
    <p>You must enter your credentials in the format: <strong>CO\username</strong></p>
    <p>Examples of valid credentials:</p>
    <ul>
        <li><strong>CO\jdoe</strong> (Assessor)</li>
        <li><strong>CO\mjohnson</strong> (Staff)</li>
        <li><strong>CO\bsmith</strong> (ITAdmin)</li>
        <li><strong>CO\tauditor</strong> (Auditor)</li>
    </ul>

    <h2>Roles and Permissions</h2>
    <p>Your role determines what actions you can perform in the system:</p>
    
    <table>
        <thead>
            <tr>
                <th>Role</th>
                <th>Permissions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Assessor</td>
                <td>View, approve syncs, inspect changes</td>
            </tr>
            <tr>
                <td>Staff</td>
                <td>Upload only</td>
            </tr>
            <tr>
                <td>ITAdmin</td>
                <td>Full access (approve, export, rollback)</td>
            </tr>
            <tr>
                <td>Auditor</td>
                <td>View and diff only (no modification)</td>
            </tr>
        </tbody>
    </table>

    <div class="warning">
        <strong>Important:</strong> If you attempt an action your role doesn't permit, you'll see an error message like the one below.
    </div>

    <div class="screenshot">
        <div style="background-color: rgba(0,0,0,0.5); padding: 20px; display: flex; justify-content: center; align-items: center;">
            <div style="background-color: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.25); width: 400px; max-width: 90%; padding: 25px; text-align: center;">
                <div style="font-size: 48px; color: #e74c3c; margin-bottom: 10px;">⚠️</div>
                <h2 style="color: #e74c3c; margin-top: 0;">Permission Denied</h2>
                <p style="margin-bottom: 20px;">Your role 'Staff' does not have permission to perform this action. Only users with 'Assessor' or 'ITAdmin' roles can approve changes.</p>
                <button style="background-color: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">OK</button>
            </div>
        </div>
        <div class="screenshot-caption">Fig. 2: Permission denied error when attempting an action your role doesn't allow</div>
    </div>

    <h2>Dashboard Overview</h2>
    <p>After logging in, you'll see the main dashboard with several sections:</p>

    <div class="screenshot">
        <div style="background-color: #f5f5f5; padding: 20px;">
            <div style="background-color: #2c3e50; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 24px; font-weight: bold;">Terra<span style="color: #3498db;">Fusion</span>Sync</div>
                <div style="font-size: 14px;">User: CO\jdoe | Role: Assessor</div>
            </div>
            
            <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
                <div style="background: white; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; padding: 20px;">
                    <h2 style="margin-top: 0; color: #2c3e50; border-bottom: 1px solid #eee; padding-bottom: 10px;">Upload Property Data File</h2>
                    <div style="display: flex; align-items: center; margin-bottom: 20px;">
                        <div style="flex: 1; padding: 8px; margin-right: 10px; border: 1px solid #ddd; border-radius: 4px; background-color: #fff;">Choose File</div>
                        <button style="background-color: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Submit</button>
                    </div>
                    <a href="#" style="display: inline-block; margin-bottom: 20px; text-decoration: none; background-color: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Download Sync Log</a>
                </div>
                
                <div style="background: white; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; padding: 20px;">
                    <h2 style="margin-top: 0; color: #2c3e50; border-bottom: 1px solid #eee; padding-bottom: 10px;">Pending Property Updates</h2>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: #f8f9fa;">
                                <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">Property ID</th>
                                <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">Filename</th>
                                <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">Timestamp</th>
                                <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">PROP_12345</td>
                                <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">property_update_05072025.xml</td>
                                <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">2025-05-07 14:30:22</td>
                                <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">PENDING</td>
                                <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">
                                    <div style="display: flex; gap: 8px;">
                                        <a href="#" style="background-color: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; text-decoration: none;">View Diff</a>
                                        <a href="#" style="background-color: #2ecc71; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; text-decoration: none;">Approve</a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="screenshot-caption">Fig. 3: Main dashboard showing upload section and pending property updates</div>
    </div>

    <h2>Uploading a File</h2>
    
    <div class="step">
        <span class="step-number">1</span>
        <strong>Click 'Choose File'</strong> and select your XML or CSV data file containing the property data updates.
    </div>
    
    <div class="step">
        <span class="step-number">2</span>
        <strong>Click 'Submit'</strong> to stage the file. The system will:
        <ul>
            <li>Calculate a SHA-256 hash of the file for verification</li>
            <li>Extract the property ID from the file contents</li>
            <li>Create a unique upload ID to track this upload</li>
            <li>Add the file to the staging area with a "PENDING" status</li>
        </ul>
    </div>
    
    <div class="step">
        <span class="step-number">3</span>
        <strong>Verify that your file appears</strong> in the "Pending Property Updates" table
    </div>
    
    <div class="note">
        <strong>Note:</strong> Staff members can upload files but cannot approve them. Assessors and ITAdmins must review and approve changes before they take effect.
    </div>

    <h2>Viewing Diffs</h2>
    <p>Before approving any changes, you should always review what will be changed:</p>
    
    <div class="step">
        <span class="step-number">1</span>
        <strong>Click 'View Diff'</strong> next to the file you want to review
    </div>
    
    <div class="screenshot">
        <div style="background-color: rgba(0,0,0,0.5); padding: 20px; display: flex; justify-content: center; align-items: center;">
            <div style="background-color: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.25); width: 800px; max-width: 90%; padding: 25px;">
                <h2 style="margin-top: 0; color: #2c3e50; border-bottom: 1px solid #eee; padding-bottom: 10px;">Property Data Changes</h2>
                
                <div style="background-color: #f8f9fa; padding: 10px; border-radius: 4px; margin-bottom: 20px; font-size: 14px;">
                    <p><span style="font-weight: bold;">Property ID:</span> PROP_12345</p>
                    <p><span style="font-weight: bold;">Filename:</span> property_update_05072025.xml</p>
                    <p><span style="font-weight: bold;">Upload ID:</span> 7fe9a2c3-5d1b-4e47-8a5e-3d916b512db9</p>
                    <p><span style="font-weight: bold;">SHA-256:</span> a3d5f7e9c2b1d8e4a6f9c2b3d8e5a7f9...</p>
                </div>
                
                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <thead>
                        <tr>
                            <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; background-color: #f8f9fa;">Field</th>
                            <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; background-color: #f8f9fa;">Current Value</th>
                            <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; background-color: #f8f9fa;">Proposed Value</th>
                            <th style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; background-color: #f8f9fa;">Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">land_value</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">$150,000</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">$165,000</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; color: green;">+$15,000</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">building_value</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">$320,000</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">$335,000</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; color: green;">+$15,000</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">tax_due</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">$4,750</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd;">$5,000</td>
                            <td style="padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; color: green;">+$250</td>
                        </tr>
                    </tbody>
                </table>
                
                <button style="background-color: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; float: right;">Close</button>
            </div>
        </div>
        <div class="screenshot-caption">Fig. 4: Diff viewer showing proposed changes to property values</div>
    </div>
    
    <div class="step">
        <span class="step-number">2</span>
        <strong>Review the changes carefully:</strong>
        <ul>
            <li>Green values indicate increases (e.g., +$15,000)</li>
            <li>Red values would indicate decreases</li>
            <li>Verify that the property ID matches what you expect</li>
            <li>Check that all changes are reasonable and appropriate</li>
        </ul>
    </div>
    
    <div class="warning">
        <strong>Important:</strong> Always verify changes before approving! This is a critical step for maintaining data integrity and ensuring accurate property records.
    </div>

    <h2>Approving Updates</h2>
    <p>Only users with the Assessor or ITAdmin role can approve changes:</p>
    
    <div class="step">
        <span class="step-number">1</span>
        <strong>After reviewing the diff,</strong> return to the main dashboard
    </div>
    
    <div class="step">
        <span class="step-number">2</span>
        <strong>Click the 'Approve' button</strong> next to the file you want to approve
    </div>
    
    <div class="step">
        <span class="step-number">3</span>
        <strong>Confirm the approval</strong> when prompted
    </div>
    
    <div class="step">
        <span class="step-number">4</span>
        <strong>The file status will change to "APPROVED"</strong> and the changes will be applied to the property data
    </div>
    
    <div class="note">
        <strong>Note:</strong> The system records who approved each change and when, maintaining a complete audit trail.
    </div>

    <h2>Exporting Logs</h2>
    <p>You can export logs of all system activity for audit and record-keeping purposes:</p>
    
    <div class="step">
        <span class="step-number">1</span>
        <strong>Click 'Download Sync Log'</strong> on the main dashboard
    </div>
    
    <div class="screenshot">
        <div style="background-color: rgba(0,0,0,0.5); padding: 20px; display: flex; justify-content: center; align-items: center;">
            <div style="background-color: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.25); width: 400px; max-width: 90%; padding: 25px; text-align: center;">
                <div style="font-size: 48px; color: #2ecc71; margin-bottom: 10px;">✓</div>
                <h2 style="color: #2c3e50; margin-top: 0;">Export Ready</h2>
                <p style="margin-bottom: 20px;">Your sync log has been prepared for download. Click the button below to download the CSV file.</p>
                <a href="#" style="display: inline-block; text-decoration: none; background-color: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 0 5px;">Download CSV</a>
                <button style="background-color: #95a5a6; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 0 5px;">Cancel</button>
            </div>
        </div>
        <div class="screenshot-caption">Fig. 5: Export logs confirmation dialog</div>
    </div>
    
    <div class="step">
        <span class="step-number">2</span>
        <strong>Click 'Download CSV'</strong> to download the log file
    </div>
    
    <div class="step">
        <span class="step-number">3</span>
        <strong>The CSV file will contain:</strong>
        <ul>
            <li>All file uploads with timestamps</li>
            <li>Property IDs</li>
            <li>File hashes</li>
            <li>Current status (PENDING, APPROVED, etc.)</li>
            <li>User information (who performed each action)</li>
        </ul>
    </div>

    <h2>Rolling Back Changes</h2>
    <p>If an error is discovered after approval, ITAdmins can roll back changes:</p>
    
    <div class="step">
        <span class="step-number">1</span>
        <strong>Locate the Upload ID</strong> of the change you want to roll back (found in the sync log or diff viewer)
    </div>
    
    <div class="step">
        <span class="step-number">2</span>
        <strong>Enter the Upload ID</strong> in the "Rollback Approved Change" section
    </div>
    
    <div class="step">
        <span class="step-number">3</span>
        <strong>Click the 'Rollback' button</strong>
    </div>
    
    <div class="step">
        <span class="step-number">4</span>
        <strong>Confirm the action</strong> when prompted
    </div>
    
    <div class="warning">
        <strong>Important:</strong> Only ITAdmin users can perform rollbacks. This action is logged for audit purposes.
    </div>

    <h2>Security Best Practices</h2>
    <ul>
        <li><strong>Never share your authentication token</strong> with anyone</li>
        <li><strong>Always review diffs before approving</strong> changes</li>
        <li><strong>Confirm the property ID is correct</strong> before staging or approving</li>
        <li><strong>Export and save logs regularly</strong> for your records</li>
        <li><strong>Log out when you're finished</strong> using the system</li>
        <li><strong>Contact the IT Department</strong> if something looks suspicious</li>
    </ul>

    <h2>Getting Help</h2>
    <p>If you need assistance using TerraFusionSync, contact:</p>
    <ul>
        <li><strong>Benton County IT Department</strong> for technical issues</li>
        <li><strong>Data Coordinator</strong> for questions about property data</li>
        <li><strong>Your supervisor</strong> for questions about approval workflows</li>
    </ul>
    
    <div class="footer">
        <p>TerraFusionSync User Guide | Version 1.0</p>
        <p>&copy; 2025 Benton County Assessor's Office. All rights reserved.</p>
    </div>
</body>
</html>